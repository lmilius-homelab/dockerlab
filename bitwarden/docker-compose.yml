version: '2.4'
services:
  bitwarden:
    image: bitwardenrs/server:latest
    labels:
    - "traefik.enable=true"
    - "traefik.http.routers.bitwarden.entrypoints=websecure"
    - "traefik.http.routers.bitwarden.rule=Host(`bitwarden.lukemilius.com`)"
    - "traefik.http.routers.bitwarden.middlewares=tfa_verify@file"
    - "traefik.http.routers.bitwarden.tls=true"
    expose:
    - 80
    volumes:
    - data:/data
    networks:
    - proxy-overlay
    restart: unless-stopped
    environment:
      WEBSOCKET_ENABLED: "true"
      SIGNUPS_ALLOWED: "true"

networks:
  proxy-overlay:
    external: true

volumes:
  data:
